{% extends 'prometey/base.html' %}
{% load static %}

{% block content %}
<div class="page-container">
    {% for block in blocks %}
    <section
        class="page-section{% if block.page == 'home' and block.order == 3 and block.block_type == 'cta' %} color-blocks-section{% endif %}"
        data-section-id="{{ block.id }}" data-bg-color="{{ block.background_color }}"
        data-text-color="{{ block.text_color }}">

        <!-- Фон секції -->
        <div class="section-background" data-bg-color="{{ block.background_color }}">
            {% if block.order == 1 and block.block_type == 'hero' %}
            <!-- Відео фон для першого блоку - десктоп -->
            <video class="section-video desktop-video" autoplay muted loop playsinline preload="metadata">
                <source
                    src="{% static 'video/' %}{% if block.page == 'home' %}main{% elif block.page == 'education' %}study{% else %}{{ block.page }}{% endif %}.mp4"
                    type="video/mp4">
            </video>
            <!-- Відео фон для першого блоку - мобільний -->
            <video class="section-video mobile-video" autoplay muted loop playsinline preload="metadata">
                <source
                    src="{% static 'video/' %}{% if block.page == 'home' %}main{% elif block.page == 'education' %}study{% else %}{{ block.page }}{% endif %}mobile.mp4"
                    type="video/mp4">
            </video>
            <!-- Блакитний фільтр поверх відео -->
            <div class="video-overlay"></div>
            {% endif %}
        </div>

        <!-- Контент секції -->
        <div class="section-content">
            <div class="container">
                {% if block.block_type == 'hero' %}
                <div class="hero-block">
                    <div class="hero-content">
                        <h1 class="hero-title">{{ block.title }}</h1>
                        {% if block.subtitle %}
                        <p class="hero-subtitle">{{ block.subtitle }}</p>
                        {% endif %}
                        <div class="hero-description">
                            {{ block.content|linebreaks }}
                        </div>
                    </div>
                </div>
                {% elif block.block_type == 'content' %}
                <div class="content-block">
                    <div class="content-header">
                        <h2 class="content-title">{{ block.title }}</h2>
                        {% if block.subtitle %}
                        <p class="content-subtitle">{{ block.subtitle }}</p>
                        {% endif %}
                    </div>
                    <div class="content-body">
                        {{ block.content|linebreaks }}
                    </div>
                </div>
                {% elif block.block_type == 'features' %}
                <div class="features-block">
                    <div class="features-header">
                        <h2 class="features-title">{{ block.title }}</h2>
                        {% if block.subtitle %}
                        <p class="features-subtitle">{{ block.subtitle }}</p>
                        {% endif %}
                    </div>
                    <div class="features-content">
                        {{ block.content|linebreaks }}
                    </div>
                </div>
                {% elif block.block_type == 'testimonials' %}
                <div class="testimonials-block">
                    <div class="testimonials-header">
                        <h2 class="testimonials-title">{{ block.title }}</h2>
                        {% if block.subtitle %}
                        <p class="testimonials-subtitle">{{ block.subtitle }}</p>
                        {% endif %}
                    </div>
                    <div class="testimonials-content">
                        {{ block.content|linebreaks }}
                    </div>
                </div>
                {% elif block.block_type == 'cta' %}
                <div class="cta-block">
                    {% if block.page == 'home' and block.order == 3 %}
                    <!-- Спеціальний макет для третього блоку головної сторінки -->
                    <div class="wrapper">
                        <div class="left"></div>
                        <div class="right">
                            <div class="right-top"></div>
                            <div class="right-bottom"></div>
                        </div>
                    </div>
                    {% else %}
                    <!-- Звичайний макет для інших CTA блоків -->
                    <div class="cta-content">
                        <h2 class="cta-title">{{ block.title }}</h2>
                        {% if block.subtitle %}
                        <p class="cta-subtitle">{{ block.subtitle }}</p>
                        {% endif %}
                        <div class="cta-description">
                            {{ block.content|linebreaks }}
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Тінь для перекриття наступної секції -->
        <div class="section-shadow"></div>
    </section>
    {% endfor %}
</div>
{% endblock %}